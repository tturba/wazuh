<ossec_config>
  <!-- Forwarding auditd logs to the Wazuh server -->
  <localfile>
    <log_format>audit</log_format>
    <location>/var/log/audit/audit.log</location>
  </localfile>

  <!-- Command monitoring (command executes every 180 seconds) -->
  <localfile>
    <log_format>command</log_format>
    <command>ps -ef | grep "[/]etc/rc.local" | awk '{print }'</command>
    <alias>ppid of rc_local</alias>
    <frequency>180</frequency>
  </localfile>

  <localfile>
    <log_format>command</log_format>
    <command>systemctl show rc-local.service --property=ActiveState | awk -F"=" '{print 
  <!-- Forwarding auditd logs to the Wazuh server -->
  
    audit
    /var/log/audit/audit.log
  

  <!-- Command monitoring (command executes every 180 seconds) -->
  
    command
    ps -ef | grep "[/]etc/rc.local" | awk '{print $3}'
    ppid of rc_local
    180
  

  
    command
    systemctl show rc-local.service --property=ActiveState | awk -F"=" '{print $2}'
    state of rc_local service
    180
  
}'</command>
    <alias>state of rc_local service</alias>
    <frequency>180</frequency>
  </localfile>
</ossec_config>
